<!--pages/index/index.wxml-->
<!-- 互动点子库 - 主页面结构 -->

<view class="container">
  <!-- 标题区域 -->
  <view class="title-section">
    <text class="main-title">🎉 互动点子库 🎊</text>
    <text class="sub-title">为您的聚会增添欢乐</text>
  </view>

  <!-- 24点算术入口 -->
  <view class="game24-section">
    <button class="game24-btn" bindtap="toggleGame24">
      🎯 24点算术
    </button>
  </view>

  <!-- 24点算术区域 -->
  <view class="game24-area" wx:if="{{showGame24}}">
    <view class="game24-header">
      <text class="game24-title">🎯 24点算术</text>
      <button class="game24-close" bindtap="toggleGame24">✕</button>
    </view>
    
    <view class="game24-rules">
      <text class="game24-rule-text">使用下面4个数字，通过 +、-、×、÷ 和括号，计算出24</text>
    </view>

    <!-- 显示4个数字 -->
    <view class="game24-numbers">
      <view class="game24-number" wx:for="{{game24Numbers}}" wx:key="index">
        {{item}}
      </view>
    </view>

    <!-- 输入表达式 -->
    <view class="game24-input-section">
      <text class="game24-input-label">输入你的算式：</text>
      <input 
        class="game24-input" 
        type="text" 
        placeholder="例如：(9 × 8) - (8 × 3)"
        value="{{game24Expression}}"
        bindinput="onGame24Input"
        confirm-type="done"
      />

      <!-- 24点算术虚拟键盘：点击符号直接插入到输入框 -->
      <view class="game24-keyboard">
        <!-- 数字行 -->
        <view class="game24-key-row">
          <button class="game24-key" data-value="1" bindtap="insertGame24Symbol">1</button>
          <button class="game24-key" data-value="2" bindtap="insertGame24Symbol">2</button>
          <button class="game24-key" data-value="3" bindtap="insertGame24Symbol">3</button>
          <button class="game24-key" data-value="4" bindtap="insertGame24Symbol">4</button>
          <button class="game24-key" data-value="5" bindtap="insertGame24Symbol">5</button>
        </view>
        <view class="game24-key-row">
          <button class="game24-key" data-value="6" bindtap="insertGame24Symbol">6</button>
          <button class="game24-key" data-value="7" bindtap="insertGame24Symbol">7</button>
          <button class="game24-key" data-value="8" bindtap="insertGame24Symbol">8</button>
          <button class="game24-key" data-value="9" bindtap="insertGame24Symbol">9</button>
          <button class="game24-key" data-value="10" bindtap="insertGame24Symbol">10</button>
        </view>

        <!-- 运算符 + 括号 -->
        <view class="game24-key-row">
          <button class="game24-key" data-value="+" bindtap="insertGame24Symbol">＋</button>
          <button class="game24-key" data-value="-" bindtap="insertGame24Symbol">－</button>
          <button class="game24-key" data-value="×" bindtap="insertGame24Symbol">×</button>
          <button class="game24-key" data-value="÷" bindtap="insertGame24Symbol">÷</button>
          <button class="game24-key" data-value="(" bindtap="insertGame24Symbol">(</button>
          <button class="game24-key" data-value=")" bindtap="insertGame24Symbol">)</button>
        </view>

        <!-- 编辑功能键：删除 / 清空 -->
        <view class="game24-key-row">
          <button class="game24-key wide" data-action="backspace" bindtap="insertGame24Symbol">⌫ 删除</button>
          <button class="game24-key wide" data-action="clear" bindtap="insertGame24Symbol">清空</button>
        </view>
      </view>

      <view class="game24-buttons">
        <button class="game24-submit-btn" bindtap="submitGame24">提交答案</button>
        <button class="game24-new-btn" bindtap="newGame24">换一组数字</button>
        <button class="game24-answer-btn" bindtap="showGame24Answer">查看答案</button>
      </view>
    </view>

    <!-- 提示信息 -->
    <view class="game24-message" wx:if="{{game24Message}}">
      <text class="game24-message-text {{game24MessageType}}">{{game24Message}}</text>
    </view>
  </view>

  <!-- 场景选择区 -->
  <view class="scene-section">
    <text class="section-title">选择场景</text>
    <!-- 横向可滚动的场景选择条，解决按钮过多显示不全的问题 -->
    <scroll-view class="scene-scroll" scroll-x="true" show-scrollbar="false">
      <view class="scene-buttons">
        <!-- 根据 sceneList 动态渲染场景按钮，方便无限扩展 -->
        <button
          wx:for="{{sceneList}}"
          wx:key="key"
          class="scene-btn {{selectedScene === item.key ? 'active' : ''}}"
          data-scene="{{item.key}}"
          bindtap="selectScene"
        >
          {{item.label}}
        </button>
      </view>
    </scroll-view>
  </view>

  <!-- 生成模式区：只有选中场景后才显示 -->
  <view class="generate-section" id="generate-section" wx:if="{{selectedScene}}">
    <text class="section-title">生成游戏</text>
    
    <!-- 随机生成按钮 -->
    <button class="random-btn" bindtap="randomGenerate">
      🎲 随机生成
    </button>

    <!-- 游戏列表：显示当前场景下的所有游戏名称 -->
    <view class="game-list">
      <text class="list-title">或选择指定游戏：</text>
      <view 
        class="game-item {{currentGame && currentGame.name === item.name ? 'active' : ''}}"
        wx:for="{{sceneGames[selectedScene]}}"
        wx:key="name"
        data-name="{{item.name}}"
        bindtap="selectGame"
      >
        {{item.name}}
      </view>
    </view>
  </view>

  <!-- 游戏详情区：只有生成游戏后才显示 -->
  <view class="detail-section" id="game-detail" wx:if="{{currentGame}}">
    <view class="detail-header">
      <text class="game-name">{{currentGame.name}}</text>
      <button class="change-btn" bindtap="changeGame">🔄 换一个</button>
    </view>

    <!-- 游戏描述 -->
    <view class="detail-item">
      <text class="detail-label">📝 游戏描述：</text>
      <text class="detail-content">{{currentGame.desc}}</text>
    </view>

    <!-- 适合人数 -->
    <view class="detail-item">
      <text class="detail-label">👥 适合人数：</text>
      <text class="detail-content">{{currentGame.people}}</text>
    </view>

    <!-- 道具列表 -->
    <view class="detail-item">
      <text class="detail-label">🎁 所需道具：</text>
      <view class="props-list">
        <view class="props-item" wx:for="{{currentGame.props}}" wx:key="*this" wx:for-item="prop">
          <text class="props-dot">•</text>
          <text>{{prop}}</text>
        </view>
      </view>
    </view>

    <!-- 规则列表 -->
    <view class="detail-item">
      <text class="detail-label">📋 游戏规则：</text>
      <view class="rules-list">
        <view class="rule-item" wx:for="{{currentGame.rules}}" wx:key="*this" wx:for-item="rule" wx:for-index="index">
          <text class="rule-num">{{index + 1}}.</text>
          <text class="rule-text">{{rule}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 联系我们区域 -->
  <view class="contact-section">
    <text class="contact-text">联系我们：736923621@qq.com</text>
  </view>
</view>
